<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°åŒ—æ·é‹çŸ¥è­˜ç‹</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
    
    <!-- CSS æ¨£å¼ç›´æ¥å¯«åœ¨é€™è£¡ -->
    <style>
        /* style.css */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap');

        body {
            font-family: 'Noto Sans TC', sans-serif; /* æ›´æ–°å­—é«” */
            background: linear-gradient(135deg, #4c1d95, #7c3aed); /* æ·±ç´«è‰²æ¼¸è®ŠèƒŒæ™¯ */
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        /* ä¸»éŠæˆ²å®¹å™¨çš„æ¨£å¼ */
        .main-container {
            background-color: rgba(255, 255, 255, 0.9); /* åŠé€æ˜ç™½è‰²èƒŒæ™¯ */
            backdrop-filter: blur(8px); /* æ¨¡ç³Šæ•ˆæœ */
            border-radius: 2rem; /* æ›´å¤§çš„åœ“è§’ */
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1); /* é™°å½± */
            max-width: 500px; /* æœ€å¤§å¯¬åº¦ */
            width: 100%;
            overflow: hidden;
            position: relative;
            /* æ·é‹è·¯ç·šåœ–ä½œç‚ºèƒŒæ™¯ï¼ŒåŠé€æ˜ç–ŠåŠ  */
            background-image: linear-gradient(rgba(255,255,255,0.9), rgba(255,255,255,0.95)), url('https://upload.wikimedia.org/wikipedia/commons/2/26/Taipei_Metro_Route_Map_2023.png');
            background-size: cover;
            background-position: center;
            min-height: 600px; /* ç¢ºä¿æœ‰è¶³å¤ é«˜åº¦ */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        /* æŒ‰éˆ•åŸºç¤æ¨£å¼ */
        .btn-primary {
            background-color: #8b5cf6; /* ç´«è‰² */
            color: white;
            font-weight: 700;
            border-radius: 1rem; /* åœ“è§’ */
            padding: 1rem 2rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .btn-primary:hover {
            background-color: #7c3aed; /* æ‡¸åœæ™‚é¡è‰²è®Šæ·± */
            transform: translateY(-3px) scale(1.05); /* æ‡¸åœæ™‚ä¸Šæµ®ä¸¦æ”¾å¤§ */
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);
        }

        /* é¸é …æŒ‰éˆ•æ¨£å¼ */
        .option-btn {
            background-color: #f3f4f6;
            color: #374151;
            border: 2px solid #e5e7eb;
            transition: all 0.2s ease;
            text-align: left;
            padding: 1rem;
            border-radius: 0.75rem; /* åœ“è§’ */
            font-weight: 500;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .option-btn:not([disabled]):hover {
            border-color: #8b5cf6; /* æ‡¸åœæ™‚é‚Šæ¡†è®Šè‰² */
            background-color: #ede9fe; /* æ‡¸åœæ™‚èƒŒæ™¯è®Šæ·º */
        }

        .option-btn:disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }

        /* æ­£ç¢ºç­”æ¡ˆæ¨£å¼ */
        .option-btn.correct {
            background-color: #10b981 !important; /* Tailwind green-500 */
            color: white !important;
            border-color: #059669 !important; /* Tailwind green-700 */
            transform: scale(1.05);
            animation: pulse-correct 0.5s;
        }

        /* éŒ¯èª¤ç­”æ¡ˆæ¨£å¼ */
        .option-btn.incorrect {
            background-color: #ef4444 !important; /* Tailwind red-500 */
            color: white !important;
            border-color: #dc2626 !important; /* Tailwind red-700 */
            animation: shake 0.5s;
        }

        /* é€²åº¦æ¢æ¨£å¼ */
        .timer-bar-inner {
            transition: width 0.2s linear; /* å¹³æ»‘éæ¸¡ */
            background: linear-gradient(90deg, #22c55e, #a3e635); /* ç¶ è‰²æ¼¸è®Š */
        }

        /* å‹•ç•« */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn { animation: fadeIn 0.5s ease-out forwards; }

        @keyframes pulse-correct {
            0% { transform: scale(1.05); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1.05); }
        }

        @keyframes shake {
            10%, 90% { transform: translateX(-2px); }
            20%, 80% { transform: translateX(2px); }
            30%, 50%, 70% { transform: translateX(-4px); }
            40%, 60% { transform: translateX(4px); }
        }

        /* é€£æ“Šé¡¯ç¤ºæ¨£å¼ */
        #combo-display {
            position: fixed; /* å›ºå®šåœ¨è¦–çª—ä¸­ */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4rem;
            font-weight: 900;
            color: #f59e0b; /* ç¥ç€è‰² */
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            pointer-events: none; /* å…è¨±é»æ“Šç©¿é€ */
            opacity: 0;
            transition: all 0.5s ease;
            z-index: 100; /* ç¢ºä¿åœ¨æœ€ä¸Šå±¤ */
            white-space: nowrap; /* é˜²æ­¢æ›è¡Œ */
        }

        #combo-display.show {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1.5); /* é¡¯ç¤ºæ™‚æ”¾å¤§ */
        }

        /* æ¨¡æ…‹è¦–çª—é—œé–‰æŒ‰éˆ• */
        .modal-close-btn {
            font-size: 2.5rem;
            line-height: 1;
            font-weight: bold;
            cursor: pointer;
            background: none;
            border: none;
            color: #a0aec0; /* æ·ºç°è‰² */
            transition: color 0.2s ease;
        }

        .modal-close-btn:hover {
            color: #4a5568; /* æ·±ç°è‰² */
        }

        /* æ·é‹åˆ—è»Šå‹•ç•«å®¹å™¨ */
        .train-animation-container {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100px; /* èª¿æ•´é«˜åº¦ä»¥å®¹ç´åœ–ç‰‡ï¼Œçµ¦äºˆæ›´å¤šç©ºé–“ */
            overflow: hidden;
            pointer-events: none; /* å…è¨±é»æ“Šç©¿é€ */
            z-index: 10;
        }

        /* æ·é‹åˆ—è»Šåœ–ç‰‡æ¨£å¼ */
        .train-animation-container img {
            position: absolute;
            bottom: 0; /* åœ–ç‰‡åº•éƒ¨å°é½Šå®¹å™¨åº•éƒ¨ */
            left: -15%; /* åˆå§‹ä½ç½® */
            width: 90px; /* èª¿æ•´åœ–ç‰‡å¯¬åº¦ï¼Œè®“å‚‘ç±³æ›´å°ä¸€é» */
            height: auto;
            animation: train-move 15s linear infinite; /* ç«è»Šç§»å‹•å‹•ç•« */
            z-index: 10;
            opacity: 0.9; /* ç¨å¾®é€æ˜ */
            transform: scaleX(-1); /* åœ–ç‰‡æ°´å¹³ç¿»è½‰ï¼Œè®“å‚‘ç±³é¢å‘è¡Œé€²æ–¹å‘ */
        }
        
        /* æ·é‹åˆ—è»Šå‹•ç•« */
        @keyframes train-move {
            0% { left: -15%; } /* å¾å·¦é‚Šå¤–å´é–‹å§‹ */
            100% { left: 115%; } /* ç§»å‹•åˆ°å³é‚Šå¤–å´ */
        }


        /* æ’è¡Œæ¦œæ¨¡æ…‹è¦–çª—åˆ—è¡¨é …é«˜äº® */
        #leaderboard-list li {
            transition: all 0.2s ease;
        }

        #leaderboard-list li.bg-amber-100 {
            background-color: #fffbeb; /* æ·ºé»ƒè‰²èƒŒæ™¯ */
            border: 1px solid #fcd34d; /* é»ƒè‰²é‚Šæ¡† */
            box-shadow: 0 2px 8px rgba(252, 211, 77, 0.4);
        }

        #leaderboard-list li span.text-amber-500 {
            color: #f59e0b; /* ç¥ç€è‰²æ–‡å­— */
        }

        /* éŸ¿æ‡‰å¼èª¿æ•´ */
        @media (max-width: 640px) {
            .main-container {
                padding: 1rem;
                border-radius: 0; /* æ‰‹æ©Ÿä¸Šç§»é™¤åœ“è§’ï¼Œå…¨è¢å¹•é¡¯ç¤º */
                height: 100vh;
                max-height: unset;
            }
            .btn-primary {
                font-size: 1.25rem;
                padding: 0.8rem 1.5rem;
            }
            .option-btn {
                font-size: 1rem;
                padding: 1rem;
            }
            #question-text {
                font-size: 1.5rem;
            }
            #combo-display {
                font-size: 3rem;
            }
            .train-animation-container img { /* èª¿æ•´åœ–ç‰‡å¯¬åº¦ */
                width: 100px; /* æ‰‹æ©Ÿä¸Šå‚‘ç±³å°ä¸€é» */
                animation-duration: 10s; /* æ‰‹æ©Ÿä¸Šç«è»Šè·‘å¿«ä¸€é» */
            }
            .train-animation-container {
                height: 80px; /* æ‰‹æ©Ÿä¸Šå®¹å™¨é«˜åº¦ä¹Ÿå°ä¸€é» */
            }
        }

        /* --- æ–°å¢æ¨£å¼ --- */
        /* åˆ†æ•¸å½ˆå‡ºå‹•ç•« */
        #score-popup {
            position: absolute;
            right: 1.5rem; /* é è¿‘åˆ†æ•¸é¡¯ç¤º */
            top: 4.5rem; /* åœ¨åˆ†æ•¸é¡¯ç¤ºä¸‹æ–¹ä¸€é» */
            font-size: 1.75rem;
            font-weight: 900;
            color: #10b981; /* ç¶ è‰² */
            opacity: 0;
            pointer-events: none; /* å…è¨±é»æ“Šç©¿é€ */
            z-index: 90; /* ç¢ºä¿åœ¨åˆ†æ•¸é¡¯ç¤ºä¹‹ä¸Šï¼Œä½†åœ¨é€£æ“Šé¡¯ç¤ºä¹‹ä¸‹ */
            animation: fade-up-out 1.5s ease-out; /* ç¶å®šå‹•ç•« */
        }
        @keyframes fade-up-out {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-40px); opacity: 0; }
        }
    </style>
    <!-- éŸ³æ•ˆé è¼‰ -->
    <audio id="background-music" loop preload="auto" volume="0.3" autoplay>
        <!-- è«‹å°‡ src æ›¿æ›ç‚ºæ‚¨çš„éŸ³æ¨‚æª”æ¡ˆçš„å…¬é–‹ URLï¼Œæˆ–å°‡æª”æ¡ˆæ”¾åœ¨èˆ‡ index.html ç›¸åŒçš„è³‡æ–™å¤¾ä¸¦ä½¿ç”¨ç›¸å°è·¯å¾‘ -->
        <source src="æ·é‹é€²ç«™éŸ³æ¨‚ - å°ç¦¾ (youtube).mp3" type="audio/mpeg">
        æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´éŸ³è¨Šå…ƒç´ ã€‚
    </audio>
    <audio id="game-start-sound" src="https://actions.google.com/sounds/v1/ui/swipe.ogg" preload="auto"></audio>
    <audio id="correct-sound" src="https://actions.google.com/sounds/v1/positive/success.ogg" preload="auto"></audio>
    <audio id="incorrect-sound" src="https://actions.google.com/sounds/v1/negative/failure.ogg" preload="auto"></audio>
</head>
<body class="min-h-screen flex items-center justify-center p-4">
    <!-- é€£æ“Šé¡¯ç¤º (ç¨ç«‹æ–¼ä¸»å®¹å™¨å¤–ï¼Œç¢ºä¿å±¤ç´šæœ€é«˜) -->
    <div id="combo-display"></div>

    <div class="main-container">
        <!-- æ·é‹åˆ—è»Šå‹•ç•«å®¹å™¨ -->
        <div id="train-container" class="train-animation-container hidden">
            <!-- å°‡ SVG æ›¿æ›ç‚ºåœ–ç‰‡ -->
            <img src="å‚‘ç±³æ­æ·é‹.png" alt="æ·é‹åˆ—è»Š">
        </div>

        <!-- é–‹å§‹ç•«é¢ -->
        <div id="start-screen" class="p-8 text-center flex flex-col items-center justify-center h-[28rem] animate-fadeIn">
            <h1 class="text-4xl md:text-5xl font-black text-violet-700 mb-2">å°åŒ—æ·é‹çŸ¥è­˜ç‹</h1>
            <p class="text-gray-600 mb-8">æŒ‘æˆ°ä½ å°å°åŒ—æ·é‹çš„äº†è§£ç¨‹åº¦ï¼</p>
            <button id="start-game-btn" class="btn-primary text-2xl">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 inline-block mr-2" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd" />
                </svg>
                é–‹å§‹éŠç©
            </button>
        </div>

        <!-- éŠæˆ²ç•«é¢ -->
        <div id="game-screen" class="p-6 md:p-8 hidden">
            <div id="score-popup"></div> <!-- æ–°å¢ï¼šåˆ†æ•¸å½ˆå‡ºå‹•ç•«å®¹å™¨ -->
            <div class="flex justify-between items-center mb-4">
                <div id="question-counter" class="text-lg font-bold text-gray-600"></div>
                <div id="score-display" class="px-4 py-2 bg-violet-100 text-violet-700 font-bold rounded-full text-lg">åˆ†æ•¸: 0</div>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-4 mb-4 overflow-hidden">
                <div id="timer-bar" class="h-full rounded-full timer-bar-inner"></div>
            </div>
            <div class="mb-6 min-h-[100px] flex items-center justify-center">
                <p id="question-text" class="text-xl md:text-2xl font-bold text-gray-800 text-center"></p>
            </div>
            <div id="options-container" class="grid grid-cols-1 gap-4"></div>
            <div id="feedback-display" class="text-center font-bold text-2xl mt-6 min-h-[40px]"></div>
        </div>

        <!-- çµæŸç•«é¢ -->
        <div id="end-screen" class="p-8 text-center hidden">
            <h3 id="end-screen-title" class="text-2xl font-bold text-amber-500 mb-2"></h3> <!-- æ–°å¢ï¼šçµæŸç¨±è™Ÿé¡¯ç¤º -->
            <h2 class="text-4xl font-black text-violet-700 mb-2">éŠæˆ²çµæŸï¼</h2>
            <p class="text-gray-600 mb-4">ä½ çš„æœ€çµ‚æˆç¸¾æ˜¯ï¼š</p>
            <p id="final-score" class="text-7xl font-bold text-violet-600 mb-8"></p>
            <div class="space-y-4">
                <button id="restart-btn" class="btn-primary w-full text-xl">å†ç©ä¸€æ¬¡</button>
                <button id="review-wrong-answers-btn" class="bg-gray-200 text-gray-700 font-bold rounded-xl p-4 w-full text-xl hover:bg-gray-300 transition">å›é¡§éŒ¯é¡Œ</button>
                <button id="show-leaderboard-btn" class="bg-amber-400 text-white font-bold rounded-xl p-4 w-full text-xl hover:bg-amber-500 transition">æŸ¥çœ‹æ’è¡Œæ¦œ</button>
            </div>
        </div>

        <!-- éŒ¯é¡Œå›é¡§æ¨¡æ…‹è¦–çª— -->
        <div id="review-modal" class="fixed inset-0 bg-black bg-opacity-60 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl p-6 w-full max-w-lg flex flex-col">
                <div class="flex justify-between items-center mb-4 flex-shrink-0">
                    <h3 class="text-2xl font-bold">éŒ¯é¡Œè©³è§£</h3>
                    <button id="close-review-modal-btn" class="text-gray-500 hover:text-gray-800 modal-close-btn">&times;</button>
                </div>
                <div class="overflow-y-auto max-h-[70vh]">
                    <div id="wrong-answers-list" class="space-y-4"></div>
                </div>
            </div>
        </div>

        <!-- æ’è¡Œæ¦œæ¨¡æ…‹è¦–çª— -->
        <div id="leaderboard-modal" class="fixed inset-0 bg-black bg-opacity-60 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl p-6 w-full max-w-lg">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-2xl font-bold text-amber-500">ğŸ† æ’è¡Œæ¦œ</h3>
                    <button id="close-leaderboard-modal-btn" class="text-gray-500 hover:text-gray-800 modal-close-btn">&times;</button>
                </div>
                <div class="overflow-y-auto max-h-[70vh]">
                    <ul id="leaderboard-list" class="space-y-2"></ul>
                </div>
            </div>
        </div>
    </div>

    <!-- å¼•å…¥å‰ç«¯éŠæˆ²é‚è¼¯ -->
    <script src="main.js"></script>
</body>
</html>