# è‡ªå‹•ç¸®åœ–ç‰¹æ•ˆç³»çµ±å¯¦ç¾ç¸½çµ

## ğŸ¯ ç³»çµ±ç‰¹è‰²

### âœ… è‡ªå‹•ç¸®åœ–ç”Ÿæˆ
- ä½¿ç”¨ `video_thumbnail` å¥—ä»¶è‡ªå‹•å¾ MP4 æª”æ¡ˆç”Ÿæˆç¸®åœ–
- ç„¡éœ€æ‰‹å‹•æº–å‚™å°é¢åœ–ç‰‡
- æ”¯æ´å¿«å–æ©Ÿåˆ¶ï¼Œæå‡è¼‰å…¥é€Ÿåº¦

### âœ… æª”æ¡ˆçµæ§‹ç°¡åŒ–
```
assets/
 â””â”€â”€ MRTå½±ç‰‡/
      â”œâ”€â”€ ç‰¹æ•ˆ1.mp4    â† åªéœ€è¦å½±ç‰‡æª”æ¡ˆ
      â”œâ”€â”€ ç‰¹æ•ˆ2.mp4
      â”œâ”€â”€ ç‰¹æ•ˆ3.mp4
      ...
      â””â”€â”€ ç‰¹æ•ˆ11.mp4
```

## ğŸ”§ æŠ€è¡“å¯¦ç¾

### 1. ä¾è³´å¥—ä»¶
```yaml
dependencies:
  video_thumbnail: ^0.5.6  # è‡ªå‹•ç”Ÿæˆç¸®åœ–
  video_player: ^2.8.2     # å½±ç‰‡æ’­æ”¾
  cloud_firestore: ^6.0.0  # Firebase è³‡æ–™åº«
```

### 2. æ ¸å¿ƒçµ„ä»¶

#### EffectThumbnail - åŸºç¤ç¸®åœ–çµ„ä»¶
```dart
class EffectThumbnail extends StatefulWidget {
  final String videoPath;  // å½±ç‰‡è·¯å¾‘
  final double? width;     // å¯¬åº¦
  final double? height;    // é«˜åº¦
  final BoxFit fit;        // å¡«å……æ–¹å¼
  final BorderRadius? borderRadius;  // åœ“è§’
  final VoidCallback? onTap;         // é»æ“Šäº‹ä»¶
  final Widget? placeholder;         // è¼‰å…¥ä¸­é¡¯ç¤º
  final Widget? errorWidget;         // éŒ¯èª¤é¡¯ç¤º
}
```

#### CachedEffectThumbnail - å¿«å–ç‰ˆæœ¬
```dart
class CachedEffectThumbnail extends StatefulWidget {
  // èˆ‡ EffectThumbnail ç›¸åŒçš„åƒæ•¸
  // é¡å¤–æä¾›å¿«å–åŠŸèƒ½
}
```

### 3. ç¸®åœ–ç”Ÿæˆæµç¨‹
```dart
Future<void> _generateThumbnail() async {
  try {
    final thumb = await VideoThumbnail.thumbnailFile(
      video: widget.videoPath,
      imageFormat: ImageFormat.JPEG,
      maxHeight: 300,
      maxWidth: 300,
      quality: 80,
    );
    
    setState(() {
      _thumbnailPath = thumb;
      _isLoading = false;
    });
  } catch (e) {
    setState(() {
      _hasError = true;
      _isLoading = false;
    });
  }
}
```

## ğŸ“± ä½¿ç”¨æ–¹å¼

### 1. åŸºæœ¬ä½¿ç”¨
```dart
EffectThumbnail(
  videoPath: 'assets/MRTå½±ç‰‡/ç‰¹æ•ˆ1.mp4',
  width: 200,
  height: 150,
  onTap: () => print('é»æ“Šäº†ç¸®åœ–'),
)
```

### 2. å¿«å–ç‰ˆæœ¬ä½¿ç”¨
```dart
CachedEffectThumbnail(
  videoPath: 'assets/MRTå½±ç‰‡/ç‰¹æ•ˆ1.mp4',
  width: 200,
  height: 150,
  borderRadius: BorderRadius.circular(12),
  onTap: () => _playVideo(),
)
```

### 3. åœ¨å•†åŸé é¢ä¸­ä½¿ç”¨
```dart
// åœ¨ GridView ä¸­ä½¿ç”¨
CachedEffectThumbnail(
  videoPath: effect.assetPath,
  fit: BoxFit.cover,
  borderRadius: const BorderRadius.vertical(top: Radius.circular(12)),
)
```

## âš¡ æ€§èƒ½å„ªåŒ–

### 1. å¿«å–æ©Ÿåˆ¶
- éœæ…‹ Map å„²å­˜å·²ç”Ÿæˆçš„ç¸®åœ–è·¯å¾‘
- é¿å…é‡è¤‡ç”Ÿæˆç›¸åŒå½±ç‰‡çš„ç¸®åœ–
- æä¾›å¿«å–æ¸…é™¤æ–¹æ³•

### 2. éŒ¯èª¤è™•ç†
- è¼‰å…¥å¤±æ•—æ™‚é¡¯ç¤ºé è¨­åœ–ç¤º
- å®Œæ•´çš„éŒ¯èª¤æ—¥èªŒè¨˜éŒ„
- ç”¨æˆ¶å‹å–„çš„éŒ¯èª¤æç¤º

### 3. è¼‰å…¥ç‹€æ…‹
- è¼‰å…¥ä¸­é¡¯ç¤ºé€²åº¦æŒ‡ç¤ºå™¨
- æ¼¸å±¤èƒŒæ™¯ä½œç‚ºé è¨­æ¨£å¼
- å¹³æ»‘çš„ç‹€æ…‹è½‰æ›

## ğŸ¨ è¦–è¦ºæ•ˆæœ

### è¼‰å…¥ä¸­ç‹€æ…‹
```dart
Container(
  decoration: BoxDecoration(
    gradient: LinearGradient(
      colors: [Colors.blue.shade300, Colors.purple.shade300],
    ),
  ),
  child: const Center(
    child: CircularProgressIndicator(color: Colors.white),
  ),
)
```

### éŒ¯èª¤ç‹€æ…‹
```dart
Container(
  decoration: BoxDecoration(
    gradient: LinearGradient(
      colors: [Colors.grey.shade300, Colors.grey.shade400],
    ),
  ),
  child: const Center(
    child: Icon(Icons.video_library, size: 48, color: Colors.white),
  ),
)
```

## ğŸ”„ è³‡æ–™æµç¨‹

### 1. åˆå§‹åŒ–
1. çµ„ä»¶åˆå§‹åŒ–
2. æª¢æŸ¥å¿«å–ï¼ˆCachedEffectThumbnailï¼‰
3. å¦‚æœå¿«å–å­˜åœ¨ä¸”æª”æ¡ˆå­˜åœ¨ï¼Œç›´æ¥é¡¯ç¤º
4. å¦å‰‡é–‹å§‹ç”Ÿæˆç¸®åœ–

### 2. ç¸®åœ–ç”Ÿæˆ
1. èª¿ç”¨ `VideoThumbnail.thumbnailFile()`
2. è¨­å®šåœ–ç‰‡æ ¼å¼ã€å°ºå¯¸ã€å“è³ª
3. å„²å­˜åˆ°å¿«å–ï¼ˆCachedEffectThumbnailï¼‰
4. æ›´æ–° UI é¡¯ç¤º

### 3. éŒ¯èª¤è™•ç†
1. æ•ç²ç”Ÿæˆéç¨‹ä¸­çš„éŒ¯èª¤
2. è¨˜éŒ„éŒ¯èª¤æ—¥èªŒ
3. é¡¯ç¤ºéŒ¯èª¤ç‹€æ…‹ UI

## ğŸ› ï¸ å¿«å–ç®¡ç†

### æ¸…é™¤å¿«å–
```dart
// æ¸…é™¤æ‰€æœ‰å¿«å–
CachedEffectThumbnail.clearCache();

// æ¸…é™¤ç‰¹å®šå½±ç‰‡çš„å¿«å–
CachedEffectThumbnail.clearCacheForVideo('assets/MRTå½±ç‰‡/ç‰¹æ•ˆ1.mp4');
```

### å¿«å–ç­–ç•¥
- ä½¿ç”¨å½±ç‰‡è·¯å¾‘ä½œç‚ºå¿«å–éµ
- æª¢æŸ¥æª”æ¡ˆæ˜¯å¦å­˜åœ¨
- è‡ªå‹•æ¸…ç†ç„¡æ•ˆçš„å¿«å–é …ç›®

## âœ… å„ªå‹¢ç‰¹é»

1. **è‡ªå‹•åŒ–**ï¼šç„¡éœ€æ‰‹å‹•æº–å‚™å°é¢åœ–ç‰‡
2. **é«˜æ•ˆèƒ½**ï¼šå¿«å–æ©Ÿåˆ¶æ¸›å°‘é‡è¤‡ç”Ÿæˆ
3. **ç”¨æˆ¶å‹å–„**ï¼šå®Œæ•´çš„è¼‰å…¥å’ŒéŒ¯èª¤ç‹€æ…‹
4. **éˆæ´»æ€§**ï¼šæ”¯æ´è‡ªå®šç¾©æ¨£å¼å’Œäº‹ä»¶
5. **ç©©å®šæ€§**ï¼šå®Œæ•´çš„éŒ¯èª¤è™•ç†æ©Ÿåˆ¶

## ğŸ¯ ä½¿ç”¨å»ºè­°

### 1. é¸æ“‡åˆé©çš„çµ„ä»¶
- **EffectThumbnail**ï¼šé©ç”¨æ–¼ä¸€æ¬¡æ€§é¡¯ç¤º
- **CachedEffectThumbnail**ï¼šé©ç”¨æ–¼é‡è¤‡é¡¯ç¤ºï¼ˆå¦‚å•†åŸåˆ—è¡¨ï¼‰

### 2. è¨­å®šé©ç•¶çš„åƒæ•¸
```dart
// é«˜å“è³ªç¸®åœ–
maxHeight: 300,
maxWidth: 300,
quality: 80,

// ä½å“è³ªç¸®åœ–ï¼ˆç¯€çœç©ºé–“ï¼‰
maxHeight: 150,
maxWidth: 150,
quality: 60,
```

### 3. éŒ¯èª¤è™•ç†
```dart
CachedEffectThumbnail(
  videoPath: effect.assetPath,
  errorWidget: Container(
    child: Text('å½±ç‰‡è¼‰å…¥å¤±æ•—'),
  ),
)
```

é€™å€‹è‡ªå‹•ç¸®åœ–ç³»çµ±å¤§å¤§ç°¡åŒ–äº†ç‰¹æ•ˆç®¡ç†æµç¨‹ï¼Œåªéœ€è¦æº–å‚™ MP4 æª”æ¡ˆï¼Œç³»çµ±æœƒè‡ªå‹•ç”Ÿæˆå°æ‡‰çš„ç¸®åœ–ï¼Œæä¾›æ›´å¥½çš„é–‹ç™¼é«”é©—å’Œç”¨æˆ¶é«”é©—ï¼
